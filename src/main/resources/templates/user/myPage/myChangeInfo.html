<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>라스트프레시 | 개인정보수정</title>
    <link rel="stylesheet" href="/front/assets/css/fragments.css">
    <link rel="stylesheet" href="/front/assets/css/user/myPageMenuBar.css">
    <link rel="stylesheet" href="/front/assets/css/user/myChangeInfo.css">
</head>
<style>
    .myPage_type1{
        height: 1345px;
    }
    @media screen and (max-width: 1000px) {
        .myPage_type1{
            height: 0px;
        }
    }
</style>
<body>
<th:block th:insert="/fragments/headerWithout.html :: headWithoutFragment"/>
<div class="page_myPage myPage_type1">
    <div id="snb" class="snb_my">
        <h2 class="tit_snb">마이페이지</h2>
        <div class="inner_snb">
            <ul class="list_menu">
                <li>
                    <a href="javascript:goOrder();">주문 내역</a>
                </li>
                <li>
                    <a href="javascript:goReview();">상품 후기</a>
                </li>
                <li>
                    <a href="javascript:goInfo();" class="on">개인 정보 수정</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="page_section section_myinfo">
        <div class="head_aticle">
            <h2 class="tit">개인 정보 수정</h2>
        </div>
        <div class="type_form member_join member_mod">
            <form id="form" name="frmMember" method="post" action="/user/myPage/modify" th:object="${user}" onsubmit="submitCheck();">
              <!--  <input type="hidden" th:field="${userNum}">-->
                <input type="hidden" name="userNum" th:value="*{userNum}"/>
                <input type="hidden" name="userKakao" th:value="*{userKakao}"/>
                <input type="hidden" name="userStatus" th:value="*{userStatus}"/>
                <table class="tbl_comm">
                    <tbody>
                    <tr class="fst">
                        <th>
                            아이디
                        </th>
                        <td>
                            <input type="text" name="userId" th:value="*{userId}" class="inp_read" id="id" readonly/>
                         <!--   <input type="text" value="rhdehdbs" readonly="" class="inp_read">-->
                        </td>
                    </tr>
                    <tr>
                        <th>현재 비밀번호</th>
                        <td>
                            <input type="password" name="originalPassword" id="originalPassword" th:value="*{userPw}">
                          <!--  <input type="hidden" name="originalPasswordCheck" th:value="*{userPw}">-->
                            <p class="txt_guide square" style="display: none;">
                                <span class="txt txt_case4 bad">현재 비밀번호를 확인해주세요</span>
                            </p>
                        </td>
                    </tr>
                    <tr class="member_pwd">
                        <th>새 비밀번호</th>
                        <td>
                            <input type="password" name="newPassword" id="newPassword" label="새 비밀번호" option="regPass" class="reg_pw bad" onclick="showNewPwText()">
                            <input type="hidden" name="newPasswordCheck" value="0">
                            <p class="txt_guide square newPwText" style="display: none;">
                                <span class="txt txt_case4">현재 비밀번호와 다르게 입력</span>
                                <span class="txt txt_case1">10자 이상 입력</span>
                                <span class="txt txt_case2">영문/숫자/특수문자(공백 제외)만 허용하며, 2개 이상 조합</span>
                            </p>
                        </td>
                    </tr>
                    <tr class="member_pwd">
                        <th>새 비밀번호 확인</th>
                        <td>
                            <input type="password" name="userPw" id="confirmPassword" label="새 비밀번호" option="regPass" class="confirm_pw bad" onclick="showRePwText()">
                            <p class="txt_guide square rePwText" style="display: none;">
                                <span class="txt txt_case1">동일한 비밀번호를 입력해주세요.</span>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <th>
                            이름
                        </th>
                        <td>
                            <input type="text" name="userName" id="name" th:value="*{userName}" label="이름" placeholder="이름을 입력해주세요">
                        </td>
                    </tr>
                    <tr>
                        <th>
                            이메일
                        </th>
                        <td>
                            <input type="text" name="userEmail" id="email" th:value="*{userEmail}" required="" option="regEmail" label="이메일" placeholder="예: marketkurly@kurly.com">
                            <button class="btn default disabled" type="button" onclick="verifyEmail()">중복확인</button>
                           <!-- <a href="#" class="btn default" onclick="verifyEmail()">중복확인</a>-->
                            <p class="txt_guide square emailOk" style="display:none;">
                                <span class="txt txt_case1 ok">사용 가능한 이메일 주소입니다</span>
                            </p>
                            <p class="txt_guide square emailNotOk" style="display:none;">
                                <span class="txt txt_case1 notOk">중복되었거나 올바르지 않은 형식의 이메일 주소 입니다 </span>
                            </p>
                        </td>
                    </tr>
                    <tr class="field_phone">
                        <th>
                            휴대폰
                        </th>
                        <td>
                            <div id="codeNum" class="code_num">
                                <input type="text" name="userPhone" id="auth_code" th:value="*{userPhone}" label="인증번호 확인" class="inp_confirm">
                                <button id="btn_cert_confirm" name="btn_cert_confirm" class="btn default disabled" type="button" onclick="showPhoneCode()">인증번호 발송</button>
                                <input type="text" name="auth_code_input" placeholder="인증번호를 입력해주세요" pattern="[0-9]*" class="inp_confirm_code" style="display:none">
                                <button id="btn_code_confirm" name="btn_code_confirm" class="btn default disabled" type="button" style="display:none;" onclick="verifyPhone()">인증하기</button>
                                <p id="countdown" class="count_down"></p>
                            </div>
                            <p class="txt_guide square phoneOk" style="display:none;">
                                <span class="txt txt_case1 ok">휴대폰 번호 인증이 완료되었습니다</span>
                            </p>
                            <p class="txt_guide square phoneNotOk" style="display:none;">
                                <span class="txt txt_case1 notOk">인증번호가 일치하지 않습니다</span>
                            </p>
                        </td>
                    </tr>
                    <tr class="field_address">
                        <th>
                            우편번호
                        </th>
                        <td>
                            <div id="codeNum2" class="code_num">

                                <input type="text" name="userAddressPostNum" id="zipcode" th:field="*{userAddressPostNum}" label="우편번호" class="inp_confirm")>
                                <button id="btn_find_adrs" class="btn default disabled" type="button" onclick="find()">우편번호 검색</button>
                            </div>
                        </td>
                    </tr>
                    <tr class="field_address">
                        <th style="padding-top: 6px;">
                            주소
                        </th>
                        <td>
                            <div id="codeNum3" class="code_num">

                                <input type="text" name="userAddress" id="address" th:field="*{userAddress}" label="주소" placeholder="주소를 입력해주세요" style="margin-top: -15px; margin-bottom: 5px;">
                                <input type="text" name="userAddressDetail" id="addressDetail" th:field="*{userAddressDetail}" label="userStatus" placeholder="상세 주소를 입력해주세요">
                            </div>
                        </td>
                    </tr>






                    <!--<tr class="select_sex">
                        <th>성별</th>
                        <td>
                            <label class="">
                                <input type="radio" name="sex" value="m">
                                <span class="ico"></span>
                                남자
                            </label>
                            <label class="checked">
                                <input type="radio" name="sex" value="w" checked="checked">
                                <span class="ico"></span>
                                여자
                            </label>
                            <label class="">
                                <input type="radio" name="sex" value="n">
                                <span class="ico"></span>
                                선택안함
                            </label>
                        </td>
                    </tr>-->
                   <!-- <tr class="birth field_birth">
                        <th>생년월일</th>
                        <td>
                            <div class="birth_day">
                                <input type="text" name="birth_year" id="birth_year" pattern="[0-9]*" value="1999" label="생년월일" size="4" maxlength="4" placeholder="YYYY">
                                <span class="bar"></span>
                                <input type="text" name="birth[]" id="birth_month" pattern="[0-9]*" value="05" label="생년월일" size="2" maxlength="2" placeholder="MM">
                                <span class="bar"></span>
                                <input type="text" name="birth[]" id="birth_day" pattern="[0-9]*" value="31" label="생년월일" size="2" maxlength="2" placeholder="DD">
                            </div>
                            <p class="txt_guide">
                                <span class="txt bad"></span>
                            </p>
                        </td>
                    </tr>-->
                    <tr>
                        <th>선택약관 동의 </th>
                        <td class="reg_agree">
                            <div class="check_view">
                                <input type="hidden" id="consentHidden" name="consent[1]" value="y">
                                <label class="label_block check_agree checked">
                                    <input type="checkbox" name="hiddenCheck" value="y" checked="checked">
                                    <span class="ico"></span>
                                    개인정보 수집·이용 동의
                                    <span class="sub">(선택)</span>
                                </label>
                                <a href="#none" class="link btn_link btn_choice">
                                    약관보기
                                </a>
                            </div>
                            <div class="layer layer_choice" style="margin-top: -153.5px;">
                                <div class="inner_layer">
                                    <div class="in_layer">
                                        <h4 class="tit_layer">
                                            개인정보 수집·이용 동의
                                            <span class="sub">(선택)</span>
                                        </h4>
                                        <div class="box_tbl">
                                            <table cellpadding="0" cellspacing="0" width="100%">
                                                <caption class="screen_out">개인정보의 수집 및 이용목적</caption>
                                                <thead>
                                                <tr>
                                                    <th scope="row" class="tit1">수집 목적</th>
                                                    <th scope="row" class="tit2">수집 항목</th>
                                                    <th scope="row" class="tit3">보유 기간</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr>
                                                    <td>맞춤형 회원 서비스 제공</td>
                                                    <td>성별, 생년월일</td>
                                                    <td class="emph">회원 탈퇴<br> 즉시 파기</td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <p class="txt_service">동의를 거부하시는 경우에도 서비스는 이용하실 수 있습니다.</p>
                                    </div>
                                    <button type="button" class="btn_ok"><span class="txt_type">확인</span></button>
                                    <button type="button" class="btn_close"><span class="screen_out"></span></button>
                                </div>
                            </div>

                        </td>
                    </tr>
                    <tr class="reg_agree">
                        <th>
                            이용약관동의
                        </th>
                        <td>
                            <div class="bg_dim"></div>
                            <div class="check_view">
                                <label class="label_block check_agree checked">
                                    <input type="checkbox" name="marketing" value="y" checked="checked">
                                    <span class="ico"></span>
                                    무료배송, 할인쿠폰 등 혜택/정보 수신 동의
                                    <span class="sub">(선택)</span>
                                </label>
                                <div class="check_event email_sms">
                                    <label class="label_block check_agree checked">
                                        <input type="checkbox" name="sms" value="y" checked="checked">
                                        <span class="ico"></span>
                                        SMS
                                    </label>
                                    <label class="label_block check_agree checked">
                                        <input type="checkbox" name="mailling" value="y" checked="checked">
                                        <span class="ico"></span>
                                        이메일
                                    </label>
                                </div>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <div id="formSubmit" class="form_footer">
                    <a href="#" class="btn default">탈퇴하기</a>
                    <button type="submit" class="btn active">회원정보수정</button>
                </div>
            </form>
        </div>
    </div>
</div>

<th:block th:insert="/fragments/footerWithout.html :: footWithoutFragment"/>
</body>
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="/front/assets/js/user/myChangeInfo.js"></script>
<script src="/front/assets/js/user/myPageListMenuSelect.js"></script>
<script th:inline="javascript">
    let userNum = [[${user.userNum}]];
    let userPw = [[${user.userPw}]];

    function goReview(){
        location.href = '/user/myPage/myReviewUnwritten';
    }

    function goOrder(){
        location.href = '/user/myPage/myOrder';
    }

    function goInfo(){
        location.href = '/user/myPage/myCheckPw?userNum=' + userNum;
    }

    function showNewPwText(){
        $(".newPwText").css({
            "display":"block"
        });
    }

    function showRePwText(){
        $(".rePwText").css({
            "display":"block"
        });
    }

    function verifyEmail(){
        if(true){ //중복 X
            $(".emailOk").css({
                "display":"block"
            });
            $("input[name='userEmail']").attr("readonly", true);
        }else{
            $(".emailNotOk").css({
                "display":"block"
            });
        }
    }

    function verifyPhone(){
        if(true){ //핸드폰 인증
            $(".phoneOk").css({
                "display":"block"
            });
            $("input[name='userPhone']").attr("readonly", true);
        }else{
            $(".phoneNotOk").css({
                "display":"block"
            });
        }
    }

    function showPhoneCode(){
        $("button[name='btn_code_confirm']").css({
            "display":"block",
            "margin-top":"9px"
        })

        $("button[name='btn_cert_confirm']").css({
            "display":"none"
        })


        $(".inp_confirm_code").css({
            "display":"block",
            "margin-top":"9px",
            "margin-right": "8px",
            "float": "left"
        });

    }




    // 주소 찾기(Daum API)
    var width = 500; //팝업의 너비
    var height = 600; //팝업의 높이

    function find() {
        new daum.Postcode({
            width: width, //생성자에 크기 값을 명시적으로 지정
            height: height,
            oncomplete: function (data) {
                var addr = ''; // 주소 변수
                if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
                    addr = data.roadAddress;
                } else { // 사용자가 지번 주소를 선택했을 경우(J)
                    addr = data.jibunAddress;
                }
                // 우편번호와 주소 정보를 해당 필드에 넣는다.
                document.getElementById('zipcode').value = data.zonecode;
                document.getElementById("address").value = addr;
                // 커서를 상세주소 필드로 이동한다.
                document.getElementById("addressDetail").value = "";
                document.getElementById("addressDetail").focus();
            }
        }).open({
            left: (window.screen.width / 2) - (width / 2),
            top: (window.screen.height / 2) - (height / 2)
        });
    }

    function submitCheck(){
        //let form = $(document.frmMember);

        if(document.getElementById("confirmPassword").value == ""){ // no input
            $('input[name=userPw]').attr('value',userPw);
        }
    }




</script>
</html>